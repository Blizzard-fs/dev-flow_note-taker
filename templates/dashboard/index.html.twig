{# templates/dashboard/index.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Dashboard — {{ appName }}{% endblock %}

{% block body %}

    {# ── Sidebar ── #}
    {% include 'partials/_sidebar.html.twig' with {
        appName:      appName,
        appVersion:   appVersion,
        currentRoute: app.request.attributes.get('_route'),
        notesCount:   notesCount,
        projects:     projects,
        user:         user,
    } %}

    {# ── Main Column ── #}
    <main class="flex-1 flex flex-col h-full overflow-hidden relative">

        {# Topbar #}
        {% include 'partials/_topbar.html.twig' with {
            environment:       environment,
            notificationCount: notificationCount,
        } %}

        {# Scrollable content #}
        <div class="flex-1 overflow-y-auto p-8 scroll-smooth">
            <div class="max-w-7xl mx-auto space-y-6">

                {# Welcome banner #}
                <div class="flex flex-col md:flex-row md:items-end justify-between gap-4">
                    <div>
                        <h1 class="text-2xl font-bold text-white mb-1">Dashboard Overview</h1>
                        <p class="text-slate-400">Welcome back, {{ user.name }}. Here's what's happening today.</p>
                    </div>
                    <div class="flex items-center text-sm text-slate-400 bg-slate-800/50 px-3 py-1 rounded border border-slate-700/50">
                        <span class="material-symbols-outlined text-[16px] mr-2">calendar_today</span>
                        <span>{{ "now"|date("M d, Y") }}</span>
                    </div>
                </div>

                {# Metric Cards #}
                {% include 'dashboard/_metrics.html.twig' with { metrics: metrics } %}

                {# Charts #}
                {% include 'dashboard/_charts.html.twig' with {
                    weeklyBars:  weeklyBars,
                    activityLog: activityLog,
                } %}

                {# Notes + Top Client #}
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    {% include 'dashboard/_recent_notes.html.twig' with { recentNotes: recentNotes } %}
                    {% include 'dashboard/_top_client.html.twig'   with { topClient: topClient } %}
                </div>

            </div>
        </div>
    </main>

{% endblock %}
